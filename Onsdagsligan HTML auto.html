<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Onsdagsligan</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, sans-serif;
      background-color: #f3f6fb;
      color: #222;
      margin: 40px;
    }

    h1 {
      text-align: center;
      color: #002b5c;
      margin-bottom: 30px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      border: 1px solid #d0d7e1;
    }

    thead th {
      text-align: center;
      vertical-align: middle;
      font-weight: 700;
      font-size: 0.9rem;
      padding: 8px 10px;
      white-space: nowrap;
      border-right: 1px solid #335a8a;
    }

    thead tr:first-child th {
      background: linear-gradient(180deg, #0057b8 0%, #003b7a 100%);
      color: #fff;
      font-size: 0.95rem;
      border-bottom: 1px solid #ffffff33;
    }

    thead tr:nth-child(2) th {
      background: linear-gradient(180deg, #004080 0%, #002b5c 100%);
      color: #ffffff;
      font-weight: 500;
      font-size: 0.85rem;
    }

    th:first-child {
      background: #002b5c;
      color: #fff;
      border-right: 1px solid #335a8a;
    }

    tbody td {
      background-color: #ffffff;
      text-align: center;
      vertical-align: middle;
      padding: 6px 6px;
      border-bottom: 1px solid #d0d7e1;
      border-right: 1px solid #e1e6ef;
      font-size: 0.95rem;
    }

    tbody td:first-child {
      font-weight: 600;
      text-align: left;
      color: #002b5c;
      padding-left: 10px;
      white-space: nowrap;
      min-width: 100px;
    }

    tbody tr:nth-child(even) td {
      background-color: #f9fbfe;
    }

    tbody tr:hover td {
      background-color: #e8f1ff;
      transition: background-color 0.15s ease-in-out;
    }

    td:last-child {
      font-weight: 700;
      color: #004080;
      background-color: #eef4ff;
    }
  </style>
</head>

<body>
  <h1>Tabell</h1>

  <table id="onsdagsligan">
    <thead id="thead"></thead>
    <tbody id="tbody"></tbody>
  </table>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
    const CSV_URL = "https://raw.githubusercontent.com/Dahlpan/suck/refs/heads/main/onsdagsligan25-26.csv"; // üëâ Byt ut denna till din riktiga raw-URL

    const monthNames = {
      Jan: "Januari", Feb: "Februari", Mar: "Mars", Apr: "April", Maj: "Maj",
      Jun: "Juni", Jul: "Juli", Aug: "Augusti", Sep: "September",
      Okt: "Oktober", Nov: "November", Dec: "December"
    };

    fetch(`${CSV_URL}?v=${Date.now()}`, { cache: "no-store" })
      .then(response => {
        if (!response.ok) throw new Error("Kunde inte h√§mta CSV");
        return response.text();
      })
      .then(csvText => {
        const results = Papa.parse(csvText.trim(), { header: true });
        const data = results.data;

        if (!data.length) {
          console.error("Ingen data i CSV!");
          return;
        }

        const columns = Object.keys(data[0]);
        const monthMap = {};

        columns.forEach(col => {
          if (col === "Namn" || col === "Tot") return;
          const [shortMonth, day] = col.split("-");
          const fullMonth = monthNames[shortMonth] || shortMonth;
          if (!monthMap[fullMonth]) monthMap[fullMonth] = [];
          monthMap[fullMonth].push(day);
        });

        // Rubriker
        let monthHeader = "<tr><th rowspan='2'>Namn</th>";
        let dateHeader = "<tr>";

        Object.keys(monthMap).forEach(month => {
          monthHeader += `<th colspan="${monthMap[month].length}">${month}</th>`;
          monthMap[month].forEach(day => {
            dateHeader += `<th>${day}</th>`;
          });
        });

        monthHeader += `<th rowspan='2'>Tot</th></tr>`;
        dateHeader += "</tr>";

        document.getElementById("thead").innerHTML = monthHeader + dateHeader;

        // Datarader
        const tbodyHTML = data.map(row => {
          let rowHTML = `<tr><td>${row["Namn"]}</td>`;
          Object.keys(monthMap).forEach(month => {
            monthMap[month].forEach(day => {
              const shortKey = Object.keys(monthNames).find(k => monthNames[k] === month) + "-" + day;
              rowHTML += `<td>${row[shortKey] || ""}</td>`;
            });
          });
          rowHTML += `<td>${row["Tot"] || ""}</td></tr>`;
          return rowHTML;
        }).join('');

        document.getElementById("tbody").innerHTML = tbodyHTML;
      })
      .catch(error => {
        console.error("Fel vid h√§mtning av CSV:", error);
      });
  </script>
</body>
</html>
